# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on merge
'on':
  push:
    branches:
      - main
jobs:
  build_and_deploy:
    runs-on: self-hosted
    # runs-on: bartholomej/angular-firebase
    steps:
      - name: Check out repository code
        uses: actions/checkout@v3
      - run: npm i --force
      - run: npm run build-prod
      - name: zip file
        run: |
          cd dist          
          zip -r landing-live.zip *
          ls -liah      
          echo `pwd`            
          echo `pwd`
          ls -liah
          scp landing-live ttc-admin@fo889.firecloud.live:/tmp/.
  cms-send-msg:
    runs-on: ubuntu-latest
    needs: build_and_deploy
    steps:
      - name: send telegram after build
        uses: appleboy/telegram-action@master
        with:
          to: -743606982
          token: 374431260:AAEj6smsnegEmmQc3bjuMWy9edKZnf5VEi0
          message: |
            ${{ github.actor }} done build for cms
            Commit message: ${{ github.event.commits[0].message }}
            Repository: ${{ github.repository }}
            live landing updated !! check index page for new feature or bugs fixed
